# ポップメイト 取り扱い説明書

スマレジから商品情報を取得し、プライスポップを簡単に作成できるツールです。

---

## 目次

1. [基本的な流れ](#基本的な流れ)
2. [Step 1: スタート画面](#step-1-スタート画面)
3. [Step 2: テンプレートを選ぶ](#step-2-テンプレートを選ぶ)
4. [Step 3: デザインを編集する](#step-3-デザインを編集する)
5. [Step 4: 商品を選ぶ](#step-4-商品を選ぶ)
6. [Step 5: 商品情報を確認・編集する](#step-5-商品情報を確認編集する)
7. [Step 6: 印刷・PDF出力](#step-6-印刷pdf出力)
8. [保存と読み込み](#保存と読み込み)
9. [カスタムテンプレートの作成](#カスタムテンプレートの作成)
10. [便利なショートカットキー](#便利なショートカットキー)
11. [よくある質問（Q&A）](#よくある質問qa)

---

## 基本的な流れ

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  テンプレート │ → │  デザイン   │ → │  商品選択   │ → │  情報編集   │ → │  印刷/PDF   │
│    選択     │    │    編集     │    │             │    │  プレビュー  │    │  出力・保存  │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

**5つのステップで簡単にポップが作れます！**

---

## Step 1: スタート画面

アプリを開くと最初に表示される画面です。

### 選べる3つの選択肢

| ボタン | 説明 |
|--------|------|
| **テンプレートから選ぶ** | 用意されたテンプレートを使ってポップを作成 |
| **保存データから選ぶ** | 以前保存したプロジェクトを開いて続きから作業 |
| **新規テンプレートを作成** | 自分でサイズを決めてオリジナルテンプレートを作成 |

> **ヒント**: 初めての方は「テンプレートから選ぶ」がおすすめです

---

## Step 2: テンプレートを選ぶ

### システムテンプレート（最初から用意されているもの）

| テンプレート名 | サイズ | 用途 |
|--------------|--------|------|
| **プライスポップ** | 91×55mm | 小さい価格札。一番よく使います |
| **A4** | 210×297mm | 大きなポップや説明POP |
| **A5** | 148×210mm | 中サイズのポップ |
| **A6** | 105×148mm | 小サイズのポップ |

### カスタムテンプレート

スタート画面の「新規テンプレートを作成」から自分で作ったテンプレートもここに表示されます（詳しくは[カスタムテンプレートの作成](#カスタムテンプレートの作成)を参照）。

### 保存テンプレート

以前「テンプレートとして保存」したデザインもこの画面に表示されます。サムネイルで中身を確認でき、すぐにデザインを再利用できます。

### テンプレートの操作

- **クリック** → そのテンプレートでデザイン編集へ進む
- **複製ボタン** → テンプレートをコピーして新しく作成
- **削除ボタン** → カスタムテンプレートや保存テンプレートを削除（確認ダイアログあり）

---

## Step 3: デザインを編集する

ポップのデザインを作成する画面です。

### 画面の構成

```
┌──────────────────────────────────────────────────────┐
│  ツールバー（要素追加ボタン、ズーム、Undo/Redo）       │
├────────────────────────────────┬─────────────────────┤
│                                │                     │
│      キャンバス               │   プロパティ         │
│    （デザイン作成エリア）       │    パネル           │
│                                │  （選択した要素の    │
│                                │   設定を変更）       │
│                                │                     │
└────────────────────────────────┴─────────────────────┘
```

### 追加できる要素

| 要素 | 説明 |
|------|------|
| **テキスト** | 文字を追加。商品名や価格を表示するのに使います |
| **画像** | 画像ファイルをアップロードして配置 |
| **図形** | 四角形、角丸四角形、円、三角形、星 |
| **線** | 直線や矢印付きの線 |
| **バーコード** | 商品コードからバーコードを自動生成（CODE128, EAN13, EAN8, UPC, CODE39, ITF14対応） |
| **QRコード** | 商品コードやURLからQRコードを自動生成 |

### プレースホルダー（自動で商品情報に置き換わる文字）

テキスト要素やバーコード・QRコードに以下の文字を入力すると、プレビュー・印刷時に自動で商品情報に置き換わります：

| プレースホルダー | 表示される内容 | 例 |
|-----------------|---------------|-----|
| `{{productName}}` | 商品名 | りんご |
| `{{price}}` | 税抜価格（¥付き） | ¥100 |
| `{{priceNumber}}` | 税抜価格（数値のみ） | 100 |
| `{{taxIncludedPrice}}` | 税込価格（¥付き・自動計算） | ¥110 |
| `{{taxIncludedPriceNumber}}` | 税込価格（数値のみ） | 110 |
| `{{description}}` | 商品説明 | 青森県産の甘いりんご |
| `{{maker}}` | メーカー名 | ○○農園 |
| `{{category}}` | カテゴリ名 | 果物 |
| `{{productCode}}` | 商品コード | 4901234567890 |
| `{{taxRate}}` | 税率（%付き） | 10% |
| `{{taxRateNumber}}` | 税率（数値のみ） | 10 |

> **重要**: プレースホルダーは `{{` と `}}` で囲んでください。大文字・小文字を正確に入力する必要があります。

> **ヒント**: 価格表示で `¥` マークを付けたくない場合は `{{priceNumber}}` や `{{taxIncludedPriceNumber}}` を使い、テキスト要素内で自由にレイアウトできます。

### 要素の編集方法

1. **選択**: キャンバス上の要素をクリック
2. **移動**: ドラッグするか、矢印キーで細かく移動（0.1mm単位）
3. **サイズ変更**: 要素の角や辺をドラッグ、またはプロパティパネルで数値入力
4. **コピー**: `Ctrl+C` → `Ctrl+V` で複製（2mmずらして貼り付け）
5. **削除**: 選択して `Delete` キーまたは `Backspace` キー
6. **元に戻す**: `Ctrl+Z` で直前の操作を取り消し（最大50回）

### プロパティパネルで変更できること

**テキストの場合:**
- フォント（20種類以上の日本語フォント）
- 文字サイズ
- 太字・斜体・下線
- 文字色・不透明度
- 配置（左揃え/中央/右揃え/均等割付）
- 垂直位置（上/中央/下）
- 行間・字間
- 縦書き/横書き
- 文字幅（横方向の伸縮）
- 自動折り返し

**図形の場合:**
- 塗りつぶし色・不透明度
- 枠線の色・太さ・不透明度
- 角の丸み（角丸四角形のみ）

**画像の場合:**
- 不透明度

**バーコードの場合:**
- バーコード形式（CODE128, EAN13など）
- 値（プレースホルダー使用可）
- バー色・背景色
- テキスト表示ON/OFF

**QRコードの場合:**
- 値（プレースホルダー使用可）
- 前景色・背景色
- 誤り訂正レベル（L/M/Q/H）

**レイヤー操作（全要素共通）:**
- 最前面へ移動
- 前面へ移動
- 背面へ移動
- 最背面へ移動

### 税込価格の端数処理

プロパティパネルで端数処理の方法を設定できます：

| 設定 | 説明 |
|------|------|
| **切り捨て** | 小数点以下を切り捨て（`Math.floor`） |
| **四捨五入** | 小数点以下を四捨五入（`Math.round`） |
| **切り上げ** | 小数点以下を切り上げ（`Math.ceil`） |

> この設定はすべての商品に共通で適用されます。

---

## Step 4: 商品を選ぶ

スマレジから商品データを取得して、ポップに使う商品を選びます。

### 画面の構成

```
┌──────────────────────────────────────────────────────┐
│  検索フィルター（キーワード、カテゴリ、メーカーなど）    │
├────────────────────────────────┬─────────────────────┤
│                                │                     │
│      商品一覧テーブル          │   選択済み商品      │
│    （チェックボックスで選択）   │    サイドバー       │
│                                │                     │
│                                │                     │
└────────────────────────────────┴─────────────────────┘
```

### 商品の検索方法

| フィルター | 使い方 |
|-----------|--------|
| **キーワード検索** | 商品名や商品コードで検索 |
| **カテゴリ** | ドロップダウンから選択（複数可） |
| **メーカー** | タグから選択（複数可） |
| **仕入先** | グループから選択（複数可） |

> 検索条件を設定したら **「検索」** ボタンを押してください。

### 商品の選択方法

1. 商品一覧から選びたい商品の **チェックボックス** にチェック
2. チェックした商品は右側の「選択済み商品」に追加される
3. **「すべて選択」** ボタンで表示中の全商品を一括選択できる

### 選択を解除する

- 右側サイドバーの商品横の **×ボタン** で個別に解除
- **「すべてクリア」** で一括解除

> **ヒント**: 商品の選択状態は検索条件を変更しても保持されます。複数回に分けて検索・選択できます。

---

## Step 5: 商品情報を確認・編集する

選んだ商品がデザインに当てはめられた状態をプレビューできます。

### 画面の構成

```
┌──────────────────────────────────────────────────────┐
│                                                      │
│      プレビューキャンバス                             │
│    （実際の印刷イメージを確認）                       │
│                                                      │
├──────────────────────────────────────────────────────┤
│  AI要約                                              │
│  ☑ │ # │ 商品名 │ 税込価格 │ 商品説明 │ ...         │
│  ☑ │ 1 │ りんご │ ¥110    │ 青森県... │ ...         │
│  ☐ │ 2 │ みかん │ ¥220    │ 愛媛産... │ ...         │
│  ☑ │ 3 │ バナナ │ ¥165    │ 南米産... │ ...         │
└──────────────────────────────────────────────────────┘
```

上下の分割バーをドラッグして、プレビューとテーブルの表示比率を調整できます。

### 操作方法

1. **商品の切り替え**: テーブルの行をクリックすると、その商品のプレビューが表示される
2. **情報の編集**: テーブル内の文字を直接クリックして編集可能（商品名・価格・説明・メーカー）
3. **行の展開**: 左端の **▶ ボタン** をクリックすると、行が展開されて長いテキストも全文表示・編集できる
4. **列幅の調整**: ヘッダーの境界をドラッグして列幅を変更できる
5. **リアルタイム反映**: 編集するとすぐにプレビューに反映される

### AI要約機能

デザインに `{{description}}` が含まれている場合、商品説明が長すぎてテキストボックスに収まらないとき、AIが自動的に要約して短くしてくれます。

#### 商品ごとのAI要約ON/OFF

テーブルの **「AI要約」列** で、商品ごとにAI要約を使うかどうかを選べます：

| 操作 | 説明 |
|------|------|
| **各行のチェックボックス** | その商品のAI要約をON/OFFに切り替え |
| **ヘッダーのチェックボックス** | 全商品のAI要約を一括でON/OFF |

- **チェックON**（デフォルト）: AIが商品説明をテキストボックスに収まるよう要約
- **チェックOFF**: 要約せず、元の商品説明をそのまま表示（はみ出す場合があります）

> **ヒント**: AI要約の結果が意図と異なる場合は、チェックを外して商品説明を手動で短く編集することもできます。

> **ヒント**: プレビュー中に「AI処理中...」と表示される場合は、AI要約の処理中です。少しお待ちください。

#### AI要約の仕組み

1. テキストボックスのサイズとフォントサイズから、表示可能な文字数を自動計算
2. 商品説明がその文字数を超える場合にAIが要約を実行
3. 要約結果はキャッシュされるため、同じ商品を再度表示する際は即座に反映されます

---

## Step 6: 印刷・PDF出力

完成したポップを印刷またはPDFで出力します。

### 画面の構成

```
┌────────────────────────────────┬─────────────────────┐
│                                │                     │
│      印刷プレビュー            │   印刷設定          │
│    （用紙に配置された          │  ・用紙サイズ       │
│     イメージ）                 │  ・枠線表示         │
│                                │  ・位置調整         │
│                                │                     │
│  ◀ Page 1 / 3 ▶              │   出力ボタン        │
│                                │  ・印刷する         │
│                                │  ・PDF書き出し      │
│                                │  ・データを保存     │
│                                │                     │
│                                │   レイアウト情報    │
│                                │   用紙情報          │
└────────────────────────────────┴─────────────────────┘
```

### 印刷設定

| 設定項目 | 説明 |
|---------|------|
| **用紙サイズ** | A4（210×297mm）、A3（297×420mm）、B4（257×364mm）、B5（182×257mm） |
| **枠あり印刷** | ON にするとカット位置のガイド線（薄いグレー枠）が表示される |
| **位置調整（上下）** | 印刷位置を上下にずらす（0.5mm単位） |
| **位置調整（左右）** | 印刷位置を左右にずらす（0.5mm単位） |

### 出力方法

| ボタン | 説明 |
|--------|------|
| **印刷する** | ブラウザの印刷画面が開く。そのまま印刷できます |
| **PDF書き出し** | PDFファイルとしてダウンロード。進捗表示あり |
| **データを保存** | プロジェクトまたはテンプレートとして保存（[保存と読み込み](#保存と読み込み)参照） |

> **ヒント**: AI要約の処理中は「テキストを最適化中...」と表示され、印刷・PDF書き出しボタンが無効になります。処理が完了するまでお待ちください。

### レイアウトの自動配置

用紙サイズとテンプレートサイズから自動的にグリッドレイアウトを計算します。

**例: プライスポップ（91×55mm）+ A4用紙の場合**
- 配置: 2列 × 5行 = 1ページあたり10面
- 余白は自動的に均等配分（上下・左右にセンタリング）

### レイアウト情報

画面右側に表示される情報：

| 項目 | 説明 |
|------|------|
| **商品数** | 選択されている商品の総数 |
| **印刷ページ数** | 必要なページ数 |
| **配置** | 列数 × 行数 |
| **空白フレーム数** | 最終ページの未使用フレーム数 |
| **テンプレート** | テンプレート名 |
| **サイズ** | テンプレートの幅 × 高さ（mm） |
| **用紙** | 選択中の用紙サイズ |
| **余白** | 自動計算された上下・左右の余白（mm） |

### ページの移動

複数ページがある場合、 **◀ ▶** ボタンでページを切り替えて確認できます。

---

## 保存と読み込み

### 保存の種類

| 種類 | 保存される内容 | 用途 |
|------|---------------|------|
| **テンプレート** | デザインのみ | 繰り返し使うデザインを保存。テンプレート選択画面に表示される |
| **プロジェクト** | デザイン＋商品データ＋税設定 | 作業途中のものを後で再開。保存データ画面に表示される |

### 保存方法

1. 印刷画面の **「データを保存」** ボタンをクリック
2. **保存タイプ** を選択（プロジェクト or テンプレート）
3. **名前** を入力（デフォルトは `POP_YYYY年MM月DD日` の形式）
4. **「保存」** をクリック

> **同名データがある場合**: 確認ダイアログが表示され、上書きするかキャンセルするか選べます。

> **上書き保存**: 既に保存済みのプロジェクトを開いている場合は「上書き保存」ボタンが表示され、ワンクリックで更新できます。

### 読み込み方法

1. スタート画面で **「保存データから選ぶ」** をクリック
2. 一覧から開きたいプロジェクトをクリック
3. デザイン・商品データ・税設定が復元され、編集画面から作業を再開

### 保存データの管理

保存プロジェクト画面では以下の操作が可能です：
- **複製**: プロジェクトのコピーを作成
- **削除**: 不要なプロジェクトを削除（確認ダイアログあり）

---

## カスタムテンプレートの作成

スタート画面の **「新規テンプレートを作成」** から、任意のサイズでオリジナルテンプレートを作れます。

### 入力項目

| 項目 | 必須 | 説明 |
|------|------|------|
| **テンプレート名** | 必須 | 50文字以内（例: 「店頭POP大」） |
| **説明** | 任意 | 100文字以内（例: 「店頭ディスプレイ用の大きめサイズ」） |
| **幅（mm）** | 必須 | 0.1〜1000mm、0.1mm単位 |
| **高さ（mm）** | 必須 | 0.1〜1000mm、0.1mm単位 |

入力中にサイズのプレビューがリアルタイムで表示されます。

**「作成してエディターへ」** ボタンを押すと、テンプレートが保存され、すぐにデザイン編集画面に進みます。

作成したカスタムテンプレートはテンプレート選択画面で「カスタム」バッジ付きで表示されます。

---

## 便利なショートカットキー

### 基本操作

| キー | 動作 |
|------|------|
| `Ctrl` + `Z` | 元に戻す（Undo） |
| `Ctrl` + `Shift` + `Z` または `Ctrl` + `Y` | やり直し（Redo） |
| `Ctrl` + `C` | コピー |
| `Ctrl` + `V` | 貼り付け（2mmオフセット） |
| `Delete` または `Backspace` | 削除 |
| `Escape` | 選択解除 |

### 移動操作

| キー | 動作 |
|------|------|
| `←` `→` `↑` `↓` | 0.1mm移動（精密移動） |
| `Shift` + `←` `→` `↑` `↓` | 1mm移動（粗移動） |

> **ヒント**: Macの場合は `Ctrl` の代わりに `Cmd` キーを使います。

---

## よくある質問（Q&A）

### Q: 商品が見つかりません
**A:** 以下を確認してください：
- キーワードの入力ミスがないか
- フィルター（カテゴリ・メーカー・仕入先）が絞り込みすぎていないか
- スマレジに商品が登録されているか
- 検索ボタンを押したか

### Q: プレースホルダーが置き換わりません
**A:** 以下を確認してください：
- `{{` と `}}` で正しく囲んでいるか
- プレースホルダー名のスペルが正しいか（大文字小文字も注意）
- 商品データが選択されているか
- 対応するプレースホルダー名は[一覧](#プレースホルダー自動で商品情報に置き換わる文字)を参照

### Q: AI要約が意図どおりにならない
**A:** いくつかの対処法があります：
- 商品データテーブルで **AI要約のチェックをOFF** にして、手動で商品説明を短く編集する
- テキストボックスのサイズを大きくして、より多くの文字が表示されるようにする
- フォントサイズを小さくして文字を多く収める

### Q: 印刷位置がずれます
**A:** 印刷画面の「位置調整」で上下・左右のオフセットを調整してください。プリンターによって微調整が必要な場合があります。0.5mm単位で調整できます。

### Q: PDFの文字がおかしい
**A:** ブラウザを再読み込みしてから、もう一度お試しください。

### Q: 保存したデータはどこにありますか？
**A:** データはブラウザ内に保存されています。
- 同じPC、同じブラウザでのみ読み込めます
- ブラウザのデータを削除すると消えてしまいます
- 大切なデータはPDFに書き出して保管しておくことをおすすめします

### Q: 別のPCで使いたい
**A:** 現在は同じPCのみで利用可能です。PDFで出力して共有することは可能です。

### Q: 用紙サイズを変えたい
**A:** 印刷画面の右側パネルにある「用紙サイズ」で **A4、A3、B4、B5** から選択できます。テンプレートサイズに応じて、1ページあたりの面数が自動計算されます。

### Q: 縦書きのテキストを入れたい
**A:** テキスト要素を選択し、プロパティパネルの「書字方向」で **縦書き** を選択してください。

---

## サポート

問題が解決しない場合は、システム管理者にお問い合わせください。

---

**ポップメイト** - スマレジ連携プライスポップ作成ツール

最終更新: 2026年2月
