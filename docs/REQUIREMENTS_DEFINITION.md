# ポップメイト 要件定義書

## 1. 概要

### 1.1. プロジェクトの目的
本プロジェクトは、スマレジAPIから商品情報を取得し、プライスポップを自動で作成するWebサービス「ポップメイト」を開発することを目的とする。手動でのデータ入力とデザイン作成の手間を削減し、誰でも簡単かつ迅速に質の高いポップを作成できる、使いやすいシンプルなシステムを目指す。

### 1.2. プロジェクトの背景
現在、プライスポップの作成は、別ソフトウェアへの手動入力とデザイン調整に多大な時間と労力を要している。この課題を解決するため、スマレジの商品情報を活用したポップ作成の自動化が求められている。

## 2. システム構成

本システムのアーキテクチャは、以下の通りとする。開発は本番環境で直接行い、各サービスを連携させる。

| コンポーネント | サービス | 役割 |
| :--- | :--- | :--- |
| **フロントエンド** | Vercel | ユーザーインターフェースの提供、バックエンドAPIの呼び出し |
| **バックエンド** | Railway | スマレジAPIとの連携、データ加工、ビジネスロジックの実行 |
| **データベース** | Supabase | 作成したポップのデザインデータ、ユーザーデータ等の永続化 |
| **バージョン管理** | GitHub | ソースコードの管理、Vercel/RailwayとのCI/CD連携 |

## 3. 機能要件

ユーザーの要求に基づき、以下の5つのステップで機能を実装する。

### Step 1: メイン画面

- **機能ID**: F-001
- **機能名**: メイン画面
- **概要**: ユーザーが操作を開始する初期画面。
- **詳細**:
    - 「テンプレートから選ぶ」と「保存データから選ぶ」の2つの選択肢を提示する。
    - **テンプレートから選ぶ**:
        - プライスポップ (A4, A5, A6)
        - オリジナルデータ（新規作成）
    - **保存データから選ぶ**:
        - 過去に作成・保存したポップデータを一覧表示し、選択して編集を再開できる。

### Step 2: テンプレートデザイン機能

- **機能ID**: F-002
- **機能名**: テンプレートデザイン機能
- **概要**: ポップのデザインを自由に編集する機能。
- **詳細**:
    - テキストボックスの挿入と編集。
    - 画像の挿入とサイズ変更。
    - フォントの種類、色、サイズの変更。
    - 表の作成と編集。
    - 全てのオブジェクト（テキスト、画像、表など）は、0.1mm単位での位置調整を可能とする。
    - 文字数カウント機能。

### Step 3: データ選択機能（スマレジ連携）

- **機能ID**: F-003
- **機能名**: データ選択機能
- **概要**: スマレジAPIから商品情報を取得し、ポップに使用するデータを選択する機能。
- **詳細**:
    - スマレジAPI（`product_ref`）を利用して商品情報を取得する。
    - 取得するデータ項目: **商品名、メーカー名、商品説明、小売価格**。
        - ※API仕様に基づき、「メーカー名」は「タグ(tag)」または「グループコード(groupCode)」から取得、「商品説明」は「説明(description)」から取得する。
    - 商品データの検索機能:
        - メーカー別（タグ）
        - カテゴリー別（部門ID）
        - 仕入れ先別（グループコード）
    - 検索結果を一覧表示し、チェックボックスで複数の商品を選択できる。

### Step 4: 商品情報編集機能

- **機能ID**: F-004
- **機能名**: 商品情報編集機能
- **概要**: 選択した商品情報をポップデザインに反映し、編集する機能。
- **詳細**:
    - 画面上部にポップのリアルタイムプレビューを表示。
    - 画面下部に、Step3で選択した商品情報の一覧を表形式で表示。
    - 表内の商品をクリックすると、その商品情報が上部のプレビューに即時反映される。
    - 表内の商品情報（商品名、価格など）は直接編集可能とし、編集内容はプレビューに即時反映される。
    - （可能であれば）プレビュー上のテキスト等を直接編集できる機能も検討する。

### Step 5: 印刷機能

- **機能ID**: F-005
- **機能名**: 印刷機能
- **概要**: 完成したポップを印刷用にレイアウトし、保存・出力する機能。
- **詳細**:
    - 編集が完了した複数のポップを、A4用紙に隙間なく自動で配置する。
    - 印刷プレビュー機能を提供し、実際の印刷イメージを確認できる。
    - ポップの周囲に細い枠線を追加でき、枠線の色も選択可能とする。
    - **データ保存機能**:
        - この段階のレイアウト情報、商品データ、デザイン情報を一つのデータとして名前を付けて保存できる。
        - 保存したデータは、メイン画面の「保存データから選ぶ」に表示され、再編集や削除が可能。
    - **PDF出力機能**:
        - レイアウトされたポップをPDF形式でダウンロードできる。

### 共通機能

- **機能ID**: F-006
- **機能名**: 進捗ステータスバー
- **概要**: 画面上部に現在の作業ステップを示すステータスバーを表示する。
- **詳細**: 「①メイン画面」→「②デザイン」→「③データ選択」→「④編集」→「⑤印刷」の進捗を視覚的に表示し、ユーザーが現在の作業段階を容易に把握できるようにする。

## 4. 非機能要件

### 4.1. UI/UX
- プロジェクト提供のブランドガイドラインに完全に準拠したデザインを実装する。
- ユーザーが直感的に操作できる、シンプルで分かりやすいインターフェースを提供する。

### 4.2. パフォーマンス
- 商品情報の編集やデザイン変更がリアルタイムでプレビューに反映される、高速なレスポンスを実現する。

### 4.3. セキュリティ
- スマレジAPIのアクセストークン等の認証情報は、バックエンドで安全に管理し、フロントエンドには公開しない。

### 4.4. 開発・保守
- プロジェクト提供の「DEVELOPMENT_RULES.md」を遵守する。
- フロントエンドとバックエンドの責務を明確に分離し、保守性の高いコードを記述する。
- GitHubでのバージョン管理を徹底し、コミットメッセージの規約に従う。

## 5. 開発ステップ

本プロジェクトは、以下のステップに従って段階的に開発を進める。

1.  **Step 1: 要件定義と基本設計**
    - 本要件定義書の作成と合意。
    - GitHubリポジトリの作成と、Supabase, Vercel, Railwayとの連携設定。
2.  **Step 2: データベース設計とAPI基盤構築**
    - Supabaseでのテーブル設計と構築。
    - バックエンド（Railway）でスマレジAPI連携の基盤を構築。
3.  **Step 3: 基本機能の実装**
    - メイン画面、データ選択機能（スマレジ連携）を実装。
4.  **Step 4: コア機能の実装**
    - テンプレートデザイン機能、商品情報編集機能を実装。
5.  **Step 5: 最終機能の実装と調整**
    - 印刷機能、データ保存・PDF出力機能を実装。
    - 全体的な動作確認と微調整。
